<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>ä¹¦å¸æŸ¥è¯¢å·¥å…·</title><style>body{font-family:"Microsoft YaHei",sans-serif;margin:20px;background:#fafafa}#main{display:none}#inputData{width:100%;height:200px;font-size:14px;padding:8px;border:1px solid #ccc;border-radius:6px;overflow:auto;background:white;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}button{padding:6px 14px;margin:8px 4px;border:none;border-radius:6px;background-color:#0078d7;color:white;cursor:pointer;display:inline-flex;align-items:center;height:34px}button:hover{background-color:#005ea6}table{border-collapse:collapse;width:100%;margin-top:10px;background:white}th,td{border:1px solid #ccc;padding:6px;text-align:left;font-size:14px}th{background-color:#f0f0f0}#result{margin-top:20px;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text;user-select:text}input[type=number]{height:34px;font-size:14px;padding:0 8px;border:1px solid #ccc;border-radius:6px;vertical-align:middle;display:inline-flex;align-items:center}</style></head><body><div id="passwordArea"><h2>è¯·è¾“å…¥å¯†ç </h2><input type="password" id="pwdInput" placeholder="è¯·è¾“å…¥å¯†ç "><button id="pwdBtn">ç¡®å®š</button><p id="pwdMsg" style="color:red;"></p></div><div id="main"><h2>ğŸ“– ä¹¦å¸æŸ¥è¯¢å·¥å…·</h2><p>å¤åˆ¶<a href="https://docs.qq.com/sheet/DUHFGbE54d0JDcWFT?tab=1i6wf3" target="_blank">ä¹¦å¸å®æ—¶æ±‡æ€»è¡¨</a>ç²˜è´´è‡³æ­¤å¤„ï¼ˆæ³¨æ„ä¸è¦ç²˜è´´ä¸ºçº¯æ–‡æœ¬ï¼‰ï¼š</p><div id="inputData" contenteditable="true" placeholder="ç²˜è´´è¡¨æ ¼å†…å®¹â€¦"></div><br><input type="number" id="numInput" placeholder="è¾“å…¥æ‰€éœ€ä¹¦å¸"><button id="searchBtn">æŸ¥è¯¢</button><button id="copyBtn">å¤åˆ¶åå•</button><button id="copyImgBtn">å¤åˆ¶è¡¨æ ¼ä¸ºå›¾ç‰‡</button><button id="downloadBtn">å¯¼å‡ºè¡¨æ ¼ä¸ºå›¾ç‰‡</button><div id="result"></div></div><script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script><script>
(()=>{const P="weread500bookcoin",S="wenxindushu_pwd_ok";let L=[],D=document.getElementById("inputData");function sM(){document.getElementById("passwordArea").style.display="none";document.getElementById("main").style.display="block"}function fT(t){if(!t)return"";let d=new Date(t.replace(/-/g,'/'));if(isNaN(d))return t;let diff=Math.floor((new Date()-d)/864e5);return diff===0?"ä»Šæ—¥å†…":diff+"å¤©å‰"}D.addEventListener("paste",e=>{e.preventDefault();let c=e.clipboardData||window.clipboardData,h=c.getData("text/html"),t=c.getData("text/plain");if(h&&h.includes("<table"))D.innerHTML=h;else{let r="<table><tbody>";for(const l of t.trim().split(/\r?\n/))r+="<tr>"+l.split(/\s+/).map(c=>`<td>${c}</td>`).join("")+"</tr>";r+="</tbody></table>";D.innerHTML=r}});function cP(){let v=document.getElementById("pwdInput").value.trim();v===P?(localStorage.setItem(S,"true"),sM()):(document.getElementById("pwdMsg").innerText="âŒ å¯†ç é”™è¯¯")}function gR(){const t=D.querySelector("table");return t?Array.from(t.rows).slice(1):[]}function search(){const n=parseFloat(document.getElementById("numInput").value),r=gR();if(!D.innerHTML.trim()){alert("è¯·å…ˆç²˜è´´è¡¨æ ¼æ•°æ®");return}if(isNaN(n)){alert("è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—");return}if(!r.length){alert("è¯·ç²˜è´´åŒ…å«è¡¨æ ¼çš„å†…å®¹");return}let f=[];for(const a of r){const c=a.cells;if(c.length<6)continue;const m=c[0].innerText.trim(),ac=[c[1].innerText.trim(),c[2].innerText.trim(),c[3].innerText.trim(),c[4].innerText.trim()],sub=c[5].innerText.trim();for(let k=0;k<ac.length;k++){const t=ac[k];if(!t)continue;const x=t.match(/\b\d+(\.\d+)?\b/),v=x?parseFloat(x[0]):null;v!==null&&v>=n-2&&v<=n+5&&f.push({n:m,a:`è´¦å·${k+1}`,c:t,u:fT(sub),e:/è¿‡æœŸ|åˆ°æœŸ/.test(t),p:v===n,v:v})}}let res=[...f],s=new Set(res.map(r=>`${r.n}|${r.a}|${r.c}`)),le=[],ln=[];for(const a of r){const c=a.cells;if(c.length<6)continue;const m=c[0].innerText.trim(),ac=[c[1].innerText.trim(),c[2].innerText.trim(),c[3].innerText.trim(),c[4].innerText.trim()],sub=c[5].innerText.trim();for(let k=0;k<ac.length;k++){const t=ac[k];if(!t)continue;const x=t.match(/\b\d+(\.\d+)?\b/),v=x?parseFloat(x[0]):null;if(v!==null&&v>n){const key=`${m}|è´¦å·${k+1}|${t}`;if(s.has(key))continue;s.add(key);const it={n:m,a:`è´¦å·${k+1}`,c:t,u:fT(sub),e:/è¿‡æœŸ|åˆ°æœŸ/.test(t),p:v===n,v:v};it.e?le.push(it):ln.push(it)}}}ln.sort((a,b)=>a.v-b.v);ln=ln.slice(0,3);res=[...res,...le,...ln];if(res.length===0){for(const a of r){const c=a.cells;if(c.length<6)continue;const m=c[0].innerText.trim(),ac=[c[1].innerText.trim(),c[2].innerText.trim(),c[3].innerText.trim(),c[4].innerText.trim()],sub=c[5].innerText.trim();for(let k=0;k<ac.length;k++){const t=ac[k];if(!t)continue;const x=t.match(/\b\d+(\.\d+)?\b/),v=x?parseFloat(x[0]):null;if(v!==null&&v>=n-10&&v<=n){const key=`${m}|è´¦å·${k+1}|${t}`;if(s.has(key))continue;s.add(key);res.push({n:m,a:`è´¦å·${k+1}`,c:t,u:fT(sub),e:/è¿‡æœŸ|åˆ°æœŸ/.test(t),p:v===n,v:v})}}}}res.sort((a,b)=>a.e&&!b.e?-1:!a.e&&b.e?1:a.v-b.v);L=res;const R=document.getElementById("result");if(!L.length){R.innerHTML="<p>âŒ æœªæ‰¾åˆ°åŒ¹é…ç»“æœ</p>";return}let h="<table><tr><th>ç¾¤æ˜µç§°</th><th>è´¦å·</th><th>ä¹¦å¸</th><th>æ›´æ–°æ—¶é—´</th></tr>";for(const r of L){let s="";r.e&&(s+="color:red;font-weight:bold;");r.p&&(s+="background:yellow;");h+=`<tr><td>${r.n}</td><td>${r.a}</td><td style="${s}">${r.c}</td><td>${r.u}</td></tr>`}R.innerHTML=h}async function cR(){if(!L.length){alert("æ— å†…å®¹å¯å¤åˆ¶");return}const n=[...new Set(L.map(r=>r.n))].join("\n");navigator.clipboard.writeText(n).catch(()=>{let t=document.createElement("textarea");t.value=n;document.body.appendChild(t);t.select();document.execCommand("copy");document.body.removeChild(t)}).then(()=>alert("âœ… åå•å·²å¤åˆ¶"))}async function dImg(){const t=document.querySelector("#result table");if(!t){alert("æ— è¡¨æ ¼å¯å¯¼å‡º");return}html2canvas(t).then(c=>{let a=document.createElement("a");a.download="æŸ¥è¯¢ç»“æœ.png";a.href=c.toDataURL();a.click()})}async function cImg(){const t=document.querySelector("#result table");if(!t){alert("æ— è¡¨æ ¼å¯å¤åˆ¶");return}try{const c=await html2canvas(t);c.toBlob(async b=>{if(!b){alert("ç”Ÿæˆå›¾ç‰‡å¤±è´¥");return}try{await navigator.clipboard.write([new ClipboardItem({"image/png":b})]);alert("âœ… è¡¨æ ¼å·²å¤åˆ¶ä¸ºå›¾ç‰‡ï¼Œå¯ç›´æ¥ç²˜è´´åˆ°å¾®ä¿¡")}catch(e){let a=document.createElement("a");a.href=URL.createObjectURL(b);a.download="è¡¨æ ¼.png";a.click();alert("âœ… å›¾ç‰‡å·²ä¸‹è½½")}})}catch(e){alert("âŒ ç”Ÿæˆå›¾ç‰‡å¤±è´¥");console.error(e)}}window.onload=()=>{localStorage.getItem(S)==="true"&&sM()};document.getElementById("pwdBtn").addEventListener("click",cP);document.getElementById("searchBtn").addEventListener("click",search);document.getElementById("copyBtn").addEventListener("click",cR);document.getElementById("downloadBtn").addEventListener("click",dImg);document.getElementById("copyImgBtn").addEventListener("click",cImg);})();
</script></body></html>
