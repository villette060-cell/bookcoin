<!DOCTYPE html><html lang="zh"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>ä¹¦å¸æŸ¥è¯¢å·¥å…·</title><style>body{font-family:"Microsoft YaHei",sans-serif;margin:20px;background:#fafafa}#a{display:none;text-align:center}#b{position:relative;width:100%;max-width:100%;height:250px;margin-bottom:10px}#c{position:absolute;top:8px;left:8px;color:#999;pointer-events:none}#d{width:100%;height:100%;overflow-y:auto;border:1px solid #ccc;border-radius:6px;padding:8px;box-sizing:border-box;font-size:14px;line-height:1.6;white-space:pre-wrap;text-align:left}button{padding:6px 14px;margin:8px 4px;border:none;border-radius:6px;background-color:#0078d7;color:white;cursor:pointer;display:inline-flex;align-items:center;height:34px;white-space:nowrap;transition:background-color .2s}button:hover{background-color:#005ea6}button.loading{background-color:#999;cursor:not-allowed}table{border-collapse:collapse;width:100%;margin-top:10px;background:white}th,td{border:1px solid #ccc;padding:6px;text-align:left;font-size:14px}th{background-color:#f0f0f0}#e{margin-top:20px;overflow:auto}pre{width:100%;background:#f9f9f9;border:1px solid #ccc;border-radius:6px;padding:8px;white-space:pre-wrap}input[type=number]{height:34px;font-size:14px;padding:0 8px;border:1px solid #ccc;border-radius:6px;vertical-align:middle;display:inline-flex;align-items:center}#f{display:flex;justify-content:center;flex-wrap:wrap;margin-top:10px}#f button{flex:0 0 auto}.g{font-weight:bold;margin-bottom:6px;text-align:center}.h{font-size:14px;color:#666;margin-top:5px}</style></head><body><div id="passwordArea"><h2>è¯·è¾“å…¥å¯†ç </h2><input type="password" id="pwdInput" placeholder="è¯·è¾“å…¥å¯†ç "><button onclick="i()">ç¡®å®š</button><p id="pwdMsg" style="color:red"></p></div><div id="a"><h2>ğŸ“– ä¹¦å¸æŸ¥è¯¢å·¥å…·</h2><div style="text-align:center;margin-bottom:10px"><button id="refreshBtn" onclick="j()">ğŸ”„ åˆ·æ–°è¡¨æ ¼</button><div id="status" class="h">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®åˆ·æ–°æˆ–æ‰‹åŠ¨å¤åˆ¶<a href="#" data-obf="1" target="_blank">ä½™é¢æ±‡æ€»è¡¨</a>ç²˜è´´è‡³ä¸‹æ–¹ï¼ˆæ³¨æ„ä¸è¦ç²˜è´´ä¸ºçº¯æ–‡æœ¬ï¼‰</div></div><div id="b"><div id="c">è‡ªåŠ¨è·å–æˆ–æ‰‹åŠ¨ç²˜è´´è¡¨æ ¼å†…å®¹</div><div id="d" contenteditable="true"></div></div><div style="margin:10px 0;text-align:center"><input type="number" id="numInput" placeholder="è¾“å…¥æ‰€éœ€ä¹¦å¸"><button onclick="k()">æŸ¥è¯¢</button></div><div id="e"></div><div id="f" style="display:none"><button onclick="l()">å¤åˆ¶åå•</button><button onclick="m()">å¤åˆ¶æŸ¥è¯¢ç»“æœ</button><button onclick="n()">å¯¼å‡ºæŸ¥è¯¢ç»“æœ</button></div></div><script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script><script>var o=[57,56,57,53,53,48,53,48,48,53,53,52,49,55,52,53],p="wenxindushu_pwd_ok",latestResult=[];// é“¾æ¥æ··æ·†ï¼šXOR key=17ï¼Œhex å­—ç¬¦ä¸²
var __enc_link = "79656561622b3e3e757e72623f60603f727e7c3e62797474653e55445957567354242575215b55724657452e6570732c207827667722", __link_key = 17;
function __decodeHexXor(h,k){var s="";for(var i=0;i<h.length;i+=2){s+=String.fromCharCode(parseInt(h.substr(i,2),16)^k)}return s}
function __applyObfLinks(){try{var L=__decodeHexXor(__enc_link,__link_key);document.querySelectorAll('a[data-obf="1"]').forEach(function(a){a.href=L});}catch(e){console.error("link decode err",e)}}function q(){var r=document.getElementById("pwdInput").value.trim(),s="";for(var t=0;t<o.length;t++){s+=String.fromCharCode(o[t]^42)}if(r===s){localStorage.setItem(p,"true");u()}else{document.getElementById("pwdMsg").innerText="âŒ å¯†ç é”™è¯¯"}}function u(){document.getElementById("passwordArea").style.display="none";document.getElementById("a").style.display="block"}window.onload=function(){if(localStorage.getItem(p)==="true")u();__applyObfLinks()};var d=document.getElementById("d"),c=document.getElementById("c");d.addEventListener("focus",()=>{c.style.display="none"});d.addEventListener("blur",()=>{d.innerText.trim()===""&&(c.style.display="block")});d.addEventListener("input",()=>{d.innerText.trim()===""?c.style.display="block":c.style.display="none"});function v(a){if(!a)return"";var b=new Date(a.replace(/-/g,"/"));if(isNaN(b))return a;var c=new Date(b.getFullYear(),b.getMonth(),b.getDate()),d=new Date(),e=new Date(d.getFullYear(),d.getMonth(),d.getDate()),f=Math.floor((e-c)/(1e3*60*60*24));return f===0?"ä»Šæ—¥å†…":f+"å¤©å‰"}async function j(){var b=document.getElementById("refreshBtn"),s=document.getElementById("status"),t=document.getElementById("d");b.classList.add("loading");b.innerText="â³ åŠ è½½ä¸­...";s.innerText="æ­£åœ¨ä»è¯»å–è¡¨æ ¼ï¼Œè¯·ç¨å€™...";t.innerHTML="<p>åŠ è½½ä¸­...</p>";try{const r=await fetch("https://äº‘å‡½æ•°åœ°å€/fetchTencentDoc");if(!r.ok)throw new Error("HTTPé”™è¯¯ï¼š"+r.status);const a=await r.json();if(!Array.isArray(a))throw new Error("è¿”å›å¼‚å¸¸");let h="<table><thead><tr><th>ç¾¤æ˜µç§°</th><th>è´¦å·1</th><th>è´¦å·2</th><th>è´¦å·3</th><th>è´¦å·4</th><th>æäº¤æ—¶é—´</th></tr></thead><tbody>";a.forEach(r=>{h+=`<tr><td>${r.name}</td><td>${r.account1||""}</td><td>${r.account2||""}</td><td>${r.account3||""}</td><td>${r.account4||""}</td><td>${r.submit_time}</td></tr>`});h+="</tbody></table>";t.innerHTML=h;b.classList.remove("loading");b.innerText="ğŸ”„ åˆ·æ–°è¡¨æ ¼";s.innerText="âœ… è¡¨æ ¼å·²åˆ·æ–°æˆåŠŸ"}catch(r){console.error(r);b.classList.remove("loading");b.innerText="ğŸ”„ åˆ·æ–°è¡¨æ ¼";s.innerText="âš ï¸ åŠ è½½å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨ç²˜è´´è¡¨æ ¼";t.innerHTML="";c.style.display="block";t.setAttribute("contenteditable","true")}}function k(){var a=document.getElementById("d");const num=parseFloat(document.getElementById("numInput").value);if(!a.querySelector("table")){alert("è¯·å…ˆåˆ·æ–°è¡¨æ ¼æˆ–æ‰‹åŠ¨ç²˜è´´æ•°æ®");return}if(isNaN(num)){alert("è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—");return}var b=a.querySelector("table"),rows=Array.from(b.rows).slice(1),parseAccounts=row=>{var c=row.cells;if(c.length<8)return[];var d=c[0].innerText.trim(),e=parseFloat(d)||10,f=d===""?"":e,g=c[1].innerText.trim(),h=[c[2].innerText.trim(),c[3].innerText.trim(),c[4].innerText.trim(),c[5].innerText.trim()],i=c[6].innerText.trim(),j=[];return h.forEach((k,l)=>{if(!k)return;var m=k.match(/\d+(\.\d+)?/),n=m?parseFloat(m[0]):null;if(n!==null){j.push({ç¾¤æ˜µç§°:g,è´¦å·:`è´¦å·${l+1}`,ä¹¦å¸:k,æäº¤æ—¶é—´:v(i),æ˜¯å¦è¿‡æœŸ:/è¿‡æœŸ|åˆ°æœŸ/.test(k),æ˜¯å¦æ”’:/æ”’/.test(k),æ˜¯å¦æš‚åœ:/æš‚åœæ¥å•/.test(k),æ˜¯å¦ä¸æ¥æ€¥å•:/ä¸æ¥æ€¥å•/.test(k),æ•°å€¼:n,ä¿¡ç”¨åˆ†:f,ä¿¡ç”¨åˆ†é€»è¾‘:e,åŸå§‹æ—¶é—´:i})}}),j},classify=r=>{if(r.æ˜¯å¦è¿‡æœŸ)return"è¿‡æœŸç»„";if(r.æ˜¯å¦æš‚åœ||r.ä¿¡ç”¨åˆ†é€»è¾‘<6)return"å¼ƒç½®ç»„";if(r.ä¿¡ç”¨åˆ†é€»è¾‘>=8){if(r.æ˜¯å¦æ”’)return"æ”’å¸ç»„";if(r.æ˜¯å¦ä¸æ¥æ€¥å•)return"ä½é€Ÿç»„";return"æ­£å¸¸ç»„"}if(r.ä¿¡ç”¨åˆ†é€»è¾‘>=6)return"ä½åˆ†ç»„";return"å¼ƒç½®ç»„"};var expiredGroup=[],normalGroup=[],slowGroup=[],zhanGroup=[],lowGroup=[],discardGroup=[];rows.forEach(r=>{parseAccounts(r).forEach(t=>{switch(classify(t)){case"è¿‡æœŸç»„":expiredGroup.push(t);break;case"æ­£å¸¸ç»„":normalGroup.push(t);break;case"ä½é€Ÿç»„":slowGroup.push(t);break;case"æ”’å¸ç»„":zhanGroup.push(t);break;case"ä½åˆ†ç»„":lowGroup.push(t);break;case"å¼ƒç½®ç»„":discardGroup.push(t);break}})});const toDateValue=s=>{if(!s)return 0;const d=new Date(s.replace(/-/g,"/"));return isNaN(d)?0:d.getTime()};const selectTop=(a,b,c,d,e=!1)=>{let f=a.filter(r=>r.æ•°å€¼>=b&&r.æ•°å€¼<=c);return f.sort((a,b)=>e?b.æ•°å€¼-a.æ•°å€¼:a.æ•°å€¼-b.æ•°å€¼).slice(0,d)},dedup=a=>{const b=new Set();return a.filter(c=>{const d=c.ç¾¤æ˜µç§°+c.è´¦å·+c.ä¹¦å¸;if(b.has(d))return!1;b.add(d);return!0})},oneRoundSearchForGroup=(a,b)=>{const c=selectTop(a,b-10,b-.001,2,!1),d=selectTop(a,b,1/0,5,!1),e=[...c,...d],f=dedup(e);return{belowNum:c,aboveNum:d,deduped:f}};let allResults=[];const groupSequence=[normalGroup,slowGroup,zhanGroup,lowGroup];for(const grp of groupSequence){const{belowNum,c, deduped}=oneRoundSearchForGroup(grp,num);allResults.push(...deduped);if(allResults.length<5)continue;if(allResults.length<=7)break;const prevLen=allResults.length-deduped.length,maxOutput=7,remaining=maxOutput-prevLen;let finalSelection=[];if(c.length>=remaining){finalSelection=c.slice(0,remaining)}else{finalSelection=[...c];const needMore=remaining-c.length;finalSelection.push(...belowNum.slice(-needMore))}allResults=allResults.slice(0,prevLen).concat(finalSelection);break}const sortGroup=a=>a.sort((b,c)=>{const d={è¿‡æœŸç»„:0,æ­£å¸¸ç»„:1,ä½é€Ÿç»„:2,æ”’å¸ç»„:3,ä½åˆ†ç»„:4,å¼ƒç½®ç»„:5};const e=d[classify(b)]??99,f=d[classify(c)]??99;if(e!==f)return e-f;if(b.æ•°å€¼!==c.æ•°å€¼)return b.æ•°å€¼-c.æ•°å€¼;if(b.ä¿¡ç”¨åˆ†é€»è¾‘!==c.ä¿¡ç”¨åˆ†é€»è¾‘)return c.ä¿¡ç”¨åˆ†é€»è¾‘-b.ä¿¡ç”¨åˆ†é€»è¾‘;return toDateValue(c.åŸå§‹æ—¶é—´)-toDateValue(b.åŸå§‹æ—¶é—´)});let expiredFiltered=[],expiredFinal=[];if(expiredGroup&&expiredGroup.length){expiredFiltered=expiredGroup.filter(r=>r.æ•°å€¼>=num-10);expiredFinal=sortGroup(expiredFiltered);}latestResult=[...expiredFinal,...sortGroup(allResults)];let highlightValue=null,highlightGroup=null,expiredCandidates=expiredGroup.filter(r=>r.æ•°å€¼>=num).map(r=>r.æ•°å€¼).sort((a,b)=>a-b);if(expiredCandidates.length>0){highlightValue=expiredCandidates[0];highlightGroup="è¿‡æœŸç»„"}else{const normalCandidates=normalGroup.filter(r=>r.æ•°å€¼>=num).map(r=>r.æ•°å€¼).sort((a,b)=>a-b);if(normalCandidates.length>0){highlightValue=normalCandidates[0];highlightGroup="æ­£å¸¸ç»„"}}const resultDiv=document.getElementById("e"),actionDiv=document.getElementById("f"),oldCalc=document.getElementById("calcSection");oldCalc&&oldCalc.remove();if(latestResult.length===0){resultDiv.innerHTML="<p>âŒ æœªæ‰¾åˆ°åŒ¹é…ç»“æœ</p>";actionDiv.style.display="none";return}let html=`<div class="g">æŸ¥è¯¢å€¼ï¼š${num}</div>`;html+="<table><tr><th>ç¾¤æ˜µç§°</th><th>è´¦å·</th><th>ä¹¦å¸</th><th>æ›´æ–°æ—¶é—´</th><th>ä¿¡ç”¨åˆ†</th></tr>";latestResult.forEach(r=>{let s="",group=classify(r);highlightValue!==null&&r.æ•°å€¼===highlightValue&&classify(r)===highlightGroup&&(s="background:yellow;font-weight:bold;");switch(group){case"è¿‡æœŸç»„":s+="color:#ff0000;"+(s.includes("font-weight:bold")?"":"font-weight:bold;");break;case"æ­£å¸¸ç»„":s+="color:#333333;"+(s.includes("font-weight:bold")?"":"font-weight:bold;");break;case"ä½é€Ÿç»„":s+="color:#336699;";break;case"æ”’å¸ç»„":s+="color:#555555;";break;case"ä½åˆ†ç»„":s+="color:#aaa;";break}html+=`<tr><td>${r.ç¾¤æ˜µç§°}</td><td>${r.è´¦å·}</td><td style="${s}">${r.ä¹¦å¸}</td><td>${r.æäº¤æ—¶é—´}</td><td>${r.ä¿¡ç”¨åˆ†}</td></tr>`});
html+="</table>";resultDiv.innerHTML=html;actionDiv.style.display="flex";const extraDiv=document.createElement("div");extraDiv.id="calcSection";extraDiv.style.textAlign="center";extraDiv.style.marginTop="12px";extraDiv.style.fontSize="16px";extraDiv.style.fontWeight="600";extraDiv.style.lineHeight="1.6";const price=Math.round(num*.1*100)/100;extraDiv.innerHTML=`<div style="margin-bottom:8px;">æˆäº¤ä»·ï¼š<span id="dealPrice">${price.toFixed(2)}</span></div><div id="feeOptions" style="display:flex;justify-content:center;flex-wrap:wrap;gap:12px;margin-bottom:8px;font-weight:normal;"><label style="display:flex;align-items:center;gap:6px;"><input type="checkbox" id="platformFee"> 6â€°å¹³å°æ‰‹ç»­è´¹</label><label style="display:flex;align-items:center;gap:6px;"><input type="checkbox" id="personalFee"> 10%ä¸ªäººæ‰‹ç»­è´¹</label></div><div id="transferResult"></div>`;actionDiv.insertAdjacentElement("afterend",extraDiv);const updateTransfer=()=>{const a=document.getElementById("platformFee").checked?0.006:0,b=document.getElementById("personalFee").checked?0.1:0,c=a+b,d=Math.round(price*(1-c)*100)/100,e=document.getElementById("transferResult");e.style.fontWeight="600";e.style.color="#333";e.innerText=c===0?"":"éœ€è½¬è´¦ï¼š"+d.toFixed(2)};document.getElementById("platformFee").addEventListener("change",updateTransfer);document.getElementById("personalFee").addEventListener("change",updateTransfer)}function l(){if(!latestResult||latestResult.length===0){alert("æ— å†…å®¹å¯å¤åˆ¶");return}navigator.clipboard.writeText([...new Set(latestResult.map(r=>r.ç¾¤æ˜µç§°))].join("\n")).then(()=>alert("âœ… åå•å·²å¤åˆ¶"))}function n(){const a=document.getElementById("e");if(!a){alert("æ— æŸ¥è¯¢ç»“æœå¯å¯¼å‡º");return}html2canvas(a).then(b=>{const c=document.createElement("a");c.download="æŸ¥è¯¢ç»“æœ.png";c.href=b.toDataURL();c.click()})}async function m(){const a=document.getElementById("e");if(!a){alert("æ— æŸ¥è¯¢ç»“æœå¯å¤åˆ¶");return}try{const b=await html2canvas(a);b.toBlob(async c=>{if(!c){alert("ç”Ÿæˆå›¾ç‰‡å¤±è´¥");return}try{await navigator.clipboard.write([new ClipboardItem({"image/png":c})]);alert("âœ… æŸ¥è¯¢ç»“æœå·²å¤åˆ¶ä¸ºå›¾ç‰‡ï¼Œå¯ç›´æ¥ç²˜è´´åˆ°å¾®ä¿¡")}catch(d){alert("âŒ å¤åˆ¶å¤±è´¥");console.error(d)}})}catch(d){alert("âŒ ç”Ÿæˆå›¾ç‰‡å¤±è´¥");console.error(d)}}</script></body></html>
